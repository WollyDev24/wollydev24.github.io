<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WollyDev Mini App</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.2/color-thief.umd.js"></script>
<style>
body {
  margin:0;
  font-family:'Inter',sans-serif;
  background:#f2f2f2;
  overflow-x:hidden;
}
.header-gradient {
  position:relative;
  width:100%;
  height:180px;
  overflow:hidden;
}
.header-gradient::before {
  content:'';
  position:absolute;
  width:100%;
  height:100%;
  top:0;left:0;
  background:linear-gradient(to bottom, var(--grad-start,#0088cc), var(--grad-mid,#005580));
  transition: background 0.3s;
}
.header-content {
  position:relative;
  z-index:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  margin-top:-50px;
}
.header-content img {
  width:90px;
  height:90px;
  border-radius:50%;
  border:3px solid #fff;
  box-shadow:0 4px 10px rgba(0,0,0,0.3);
}
.header-content h1 {
  margin:8px 0 0;
  font-size:1.5rem;
  font-weight:700;
  color:#111;
}
.header-content p {
  margin:4px 0 0;
  font-size:0.95rem;
  color:#333;
}
.section {
  padding:12px 16px;
  margin-bottom:16px;
}
.card {
  display:block;
  padding:14px 16px;
  margin-bottom:12px;
  border-radius:16px;
  background:white;
  box-shadow:0 3px 6px rgba(0,0,0,0.08);
  transition:transform 0.25s, box-shadow 0.25s;
}
.card:hover {
  transform:translateY(-2px);
  box-shadow:0 6px 14px rgba(0,0,0,0.12);
}
.bottom-bar {
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:white;
  border-radius:9999px;
  display:flex;
  justify-content:space-around;
  align-items:center;
  width:220px;
  height:60px;
  z-index:50;
  box-shadow:0 4px 16px rgba(0,0,0,0.15);
}
.bottom-bar button {
  flex:1;
  font-size:1.5rem;
  background:none;
  border:none;
  cursor:pointer;
  opacity:0.6;
  transition:transform 0.2s, opacity 0.2s;
}
.bottom-bar button.active {
  opacity:1;
  transform:scale(1.2);
}
.page {
  display:none;
  opacity:0;
  transform:translateY(20px);
  transition:opacity 0.3s, transform 0.3s;
}
.page.active {
  display:block;
  opacity:1;
  transform:translateY(0);
}
</style>
</head>
<body>

<div class="header-gradient"></div>
<div class="header-content">
  <img id="pfp" src="https://wollydev24.github.io/telegram_icon.jpg" alt="Profile">
  <h1>wollydev24</h1>
  <p>GitHub Mini App Dashboard</p>
</div>

<div id="content" style="padding:16px; padding-bottom:100px;"></div>

<div class="bottom-bar">
  <button id="homeBtn" class="active">üè†</button>
  <button id="giveawayBtn">üéÅ</button>
  <button id="projectsBtn">üìÇ</button>
  <button id="devicesBtn">üì±</button>
</div>

<script>
const content=document.getElementById('content');
const baseURL="https://wollydev24.github.io/";

// --- FETCH JSON ---
async function fetchJSON(file){
  const res=await fetch(baseURL+file+"?nocache="+Date.now());
  if(!res.ok) throw new Error("Failed to fetch "+file);
  return await res.json();
}

// --- PAGES ---
const pages={
home:async()=>{
  try{
    const res=await fetch("https://api.github.com/users/wollydev24/events/public");
    if(!res.ok) throw new Error("GitHub API error");
    const events=await res.json();
    const commits=[];
    for(const e of events){
      if(e.type==="PushEvent"){
        e.payload.commits.forEach(c=>{
          commits.push({message:c.message,repo:e.repo.name});
        });
      }
      if(commits.length>=3) break;
    }
    return `<div class="section"><h2>üìù Latest 3 Commits</h2>`+
      commits.slice(0,3).map(c=>`<div class="card"><p>${c.message}</p><p style="font-size:0.8rem;color:#555;">${c.repo}</p></div>`).join('')+
      `</div>`;
  }catch(e){
    return `<p class="card" style="color:red;">‚ö†Ô∏è Failed to load commits</p>`;
  }
},
giveaway:async()=>{
  try{
    const data=await fetchJSON("giveaway.json");
    return `<div class="section"><h2>üéÅ Giveaways</h2>`+
      (data.items && data.items.length>0
        ? data.items.map(i=>`<div class="card"><b>${i.title}</b><br>${i.description}</div>`).join('')
        : `<div class="card">‚ùå No giveaways are running right now.</div>`)+'</div>';
  }catch(e){return `<p class="card" style="color:red;">‚ö†Ô∏è Failed to load giveaways</p>`;}
},
projects:async()=>{
  try{
    const data=await fetchJSON("projects.json");
    return `<div class="section"><h2>üìÇ Projects</h2>`+
      (data.projects && data.projects.length>0
        ? data.projects.map(p=>`<div class="card"><b>${p.name}</b><br>${p.description}</div>`).join('')
        : `<div class="card">‚ùå No projects found.</div>`)+'</div>';
  }catch(e){return `<p class="card" style="color:red;">‚ö†Ô∏è Failed to load projects</p>`;}
},
devices:async()=>{
  try{
    const data=await fetchJSON("devices.json");
    return `<div class="section"><h2>üì± Devices</h2>`+
      (data.devices && data.devices.length>0
        ? data.devices.map(d=>`<div class="card"><b>${d.name}</b><br>${d.specs||''}</div>`).join('')
        : `<div class="card">‚ùå No devices listed.</div>`)+'</div>';
  }catch(e){return `<p class="card" style="color:red;">‚ö†Ô∏è Failed to load devices</p>`;}
}
};

// --- LOAD PAGE ---
async function loadPage(page){
  content.innerHTML='<p style="text-align:center;color:#777;">Loading...</p>';
  content.innerHTML=await pages[page]();
  document.querySelectorAll('.bottom-bar button').forEach(b=>b.classList.remove('active'));
  document.getElementById(page+'Btn').classList.add('active');
}

document.getElementById('homeBtn').addEventListener('click',()=>loadPage('home'));
document.getElementById('giveawayBtn').addEventListener('click',()=>loadPage('giveaway'));
document.getElementById('projectsBtn').addEventListener('click',()=>loadPage('projects'));
document.getElementById('devicesBtn').addEventListener('click',()=>loadPage('devices'));

// --- GRADIENT FROM PFP ---
window.addEventListener("load",()=>{
  const img=new Image();
  img.crossOrigin="Anonymous";
  img.src="https://wollydev24.github.io/telegram_icon.jpg";
  img.onload=()=>{
    const colorThief=new ColorThief();
    const [r,g,b]=colorThief.getColor(img);
    document.documentElement.style.setProperty('--grad-start',`rgba(${r},${g},${b},1)`);
    document.documentElement.style.setProperty('--grad-mid',`rgba(${r},${g},${b},0)`);
  };
});

loadPage('home');
</script>

</body>
</html>
